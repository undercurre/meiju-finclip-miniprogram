<!-- sub-package/sda-cloud-menu/pages/detail/detail.wxml -->
<view class="wrapper" wx:if="{{isInit}}">
  <!-- 食谱图片 -->
  <image class="header-image" mode="widthFix" src="{{menuDetailData.imageUrl}}"></image>
  <!-- 导航栏 -->
  <view class="header-wrapper">
    <mx-nav-bar title="{{navBarModel.title}}"
                fixed="{{true}}"
                show-bg="{{navBarModel.isShowBgTransparent}}"
                left-arrow-color="{{navBarModel.arrowColor}}"
                bg-color="{{navBarModel.bgColor}}"
                bind:click-left="onClickBack" />
  </view>
  <view class="main-wrapper">
    <!-- 食谱名称 -->
    <view class="menu-name">{{menuDetailData.name}}</view>
    <!-- 食谱数据(人数、收藏) -->
    <!--<view class="menu-statistics">279人做过 · 56收藏</view>-->
    <!-- 评分 -->
    <!-- <view class="score-wrapper">
      <view class="score-icon-wrapper">
        <image wx:for="{{5}}" wx:key="index" src="https://ce-cdn.midea.com/ccs/icon/ctrl5/common/img/recipe/score-none.png" class="score-icon"></image>
        <text class="score-title">0.0</text>
      </view>
      <text class="score-text">0个评分</text>
    </view> -->
    <!-- 食谱描述 -->
    <view class="recipe-desc-wrapper">
      <text class="recipe-desc-letter">{{menuDetailData.description||'--'}}</text>
      <view class="see-more" wx:if="{{hasShowAllLabel}}"
            bindtap="onClickSeeMore">{{isShowAllContent?'展开':'收起'}}</view>
    </view>
    <!-- 食色研究所 -->
    <view class="search-wrapper">
      <image src="{{menuDetailData.author.avatar}}" class="search-image"></image>
      <view class="search-image-text">{{menuDetailData.author.name}}</view>
      <view class="search-desc">
        <view class="search-desc-item" wx:for="{{searchInfo}}" wx:key="index">
          <view class="search-desc-item-title">{{item.name}}</view>
          <view class="search-desc-item-desc">{{item.value}}</view>
        </view>
      </view>
    </view>
    <!-- 营养信息 -->
    <view class="nutrition-wrapper">
      <view class="nutrition-title">
        <view class="nutrition-title-left-text">营养信息</view>
        <view class="nutrition-title-right-text" bindtap="onClickNrv">
          <text>NRV%</text>
          <image class="nrv-icon" src="{{iconUrl.nrv}}"></image>
        </view>
      </view>
      <view class="nutrition-list-more" wx:if="{{isShowNutritionDetail}}">
        <view class="nutrition-list-more-item" wx:for="{{firstFour}}" wx:key="index">
          <view class="nutrition-list-more-item-content">
            <text class="nutrition-list-more-item-key">{{item.name}}</text>
            <view class="nutrition-list-more-item-detail">
              <text class="nutrition-list-more-item-value">{{item.value}}{{item.unitName}}</text>
              <view class="nutrition-list-more-item-divider"></view>
              <text class="nutrition-list-more-item-value">NRV：</text>
              <text class="nutrition-list-more-item-key">{{item.nrv}}%</text>
            </view>
          </view>
          <view class="nutrition-list-more-item-rate">
            <view class="nutrition-list-more-item-progress"
                  style="{{'width:'+item.nrv+'%;'}}"></view>
          </view>
        </view>
      </view>
      <view class="nutrition-desc">
        <view class="nutrition-desc-item" wx:for="{{nutritionInfo}}" wx:key="index">
          <view class="nutrition-desc-item-title">{{item.name}}</view>
          <view class="nutrition-desc-item-desc">{{item.value}}</view>
        </view>
      </view>
      <view class="extraWrapper" bindtap="onClickMoreImg" animation="{{animationData}}">
        <image src="{{more}}" class="more-img"></image>
      </view>
    </view>
    <!-- 食材清单 -->
    <view class="m-ingredient">
      <view class="ingredient-header">
        <text class="block-title">食材清单</text>
      </view>
    </view>
    <view class="ingredient-list-wrapper">
      <view class="ingredient-list-title-wrapper">
        <text class="ingredient-list-title">主食材</text>
        <view>
          <text class="{{ingredientUnitType==='general'?'ingredient-list-right-title-standard':'ingredient-list-right-title-common'}}"
                data-type="general"
                bindtap="onChangeUnit">通俗单位</text>
          <text class="ingredient-list-right-title-common"> / </text>
          <text class="{{ingredientUnitType==='accurate'?'ingredient-list-right-title-standard':'ingredient-list-right-title-common'}}"
                data-type="accurate"
                bindtap="onChangeUnit">标准单位</text>
        </view>
      </view>
      <view class="ingredient-list">
        <view class="ingredient-list-item" wx:for="{{ingredientList}}" wx:key="index">
          <view>{{item.name}}</view>
          <view>{{item.value}}</view>
        </view>
      </view>
    </view>
    <view class="ingredient-list-wrapper">
      <view class="ingredient-list-title">辅料</view>
      <view class="ingredient-list">
        <view class="ingredient-list-item" wx:for="{{ingredientHelpList}}" wx:key="index">
          <view>{{item.name}}</view>
          <view>{{item.value}}</view>
        </view>
      </view>
    </view>
    <!-- 营养师Tips -->
    <view class="dietitian-tips-wrapper" wx:if="{{menuDetailData.tips}}">
      <view class="dietitian-tips-title-wrapper">
        <view class="dietitian-tips-title">
          <image src="https://ce-cdn.midea.com/ccs/icon/ctrl6/sdaUi/icon-tips.png" class="tips-icon" />
          <view>营养师Tips</view>
        </view>
      </view>
      <view class="dietitian-tips-desc">{{menuDetailData.tips}}</view>
      <image class="tips-image" src="https://ce-cdn.midea.com/ccs/icon/ctrl6/sdaUi/icon-dietitian.png"></image>
    </view>
    <!-- 食谱步骤 -->
    <view wx:if="{{stepList.length>0}}">
      <view class="m-ingredient">
        <view class="ingredient-header">
          <text class="block-title">食谱步骤</text>
        </view>
      </view>
      <view class="step-wrapper" wx:for="{{stepList}}" wx:key="index">
        <view class="step-text">{{index+1}}/{{stepList.length}}</view>
        <image src="{{item.pic}}" class="step-image"></image>
        <view class="step-desc">{{item.desc}}</view>
      </view>
    </view>
  </view>
  <view class="bottom-tip-template" style="height:{{isIpx?'168':'128'}}rpx"></view>
  <view class="bottom-tip" style="height:{{isIpx?'168':'128'}}rpx">
    <view class="start-button" bindtap="onClickStart">
      <view class="disabled-mask" wx:if="{{!deviceInfo.isOnline||deviceInfo.isError}}"></view>
      <text>一键启动</text>
    </view>
  </view>
</view>
<view class="loading-wrapper" wx:else>
  <trojan-horse isShowHorse="{{true}}"></trojan-horse>
</view>
<midea-toast id="media-toast" />
<mx-popup bind:close="closeTipModal"
          show="{{tipModal.isShow}}"
          position="bottom"
          round="true">
  <view class="tip-modal-wrapper">
    <view class="title-wrapper">
      <text class="title">{{tipModal.title}}</text>
      <image class="btn-close" src="{{iconUrl.close}}" bindtap="closeTipModal"></image>
    </view>
    <view class="content-wrapper">{{tipModal.content}}</view>
  </view>
</mx-popup>
